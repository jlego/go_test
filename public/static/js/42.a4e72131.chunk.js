(this["webpackJsonpjlw-mes-admin"]=this["webpackJsonpjlw-mes-admin"]||[]).push([[42],{354:function(e,t){},405:function(e,t){},406:function(e,t){},663:function(e,t,n){"use strict";n.r(t);var r=n(66),a=n(34),o=n(31),c=n(44),i=n(99),u=n(100),s=n(8),f=n.n(s),l=n(0),p=n.n(l),h=n(55),d=n(403),m=n.n(d);function b(e,t){var n=document.createElement("a");n.download=t,n.style.display="none",n.href=URL.createObjectURL(e),document.body.appendChild(n),n.click(),document.body.removeChild(n),setTimeout((function(){URL.revokeObjectURL(e)}),100)}var v=function(e){Object(i.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(o.a)(this,n);for(var c=arguments.length,i=new Array(c),u=0;u<c;u++)i[u]=arguments[u];return(e=t.call.apply(t,[this].concat(i))).tmpDown="",e.downloadExcel=Object(a.a)(f.a.mark((function t(){var n,a,o,c,i,u,s,l,p,h;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.props,a=n.data,o=n.fileType,c=n.fileName,"function"!==typeof a){t.next=5;break}return t.next=4,a();case 4:a=t.sent;case 5:if((a=Array.isArray(a)?a:[]).length){t.next=8;break}return t.abrupt("return");case 8:for(s in i=a[0],a.unshift({}),u=[],i)u.push(s),a[0][s]=s;l=[],a.map((function(t,n){return u.map((function(a,o){return Object(r.a)({},{v:t[a],position:(o>25?e.getCharCol(o):String.fromCharCode(65+o))+(n+1)})}))})).reduce((function(e,t){return e.concat(t)})).forEach((function(e,t){return l[e.position]={v:e.v}})),p=Object.keys(l),h={SheetNames:["mySheet"],Sheets:{mySheet:Object(r.a)({},l,{"!ref":p[0]+":"+p[p.length-1]})}},e.tmpDown=new Blob([e.str2char(m.a.write(h,{bookType:void 0===o?"xlsx":o,bookSST:!1,type:"binary"}))],{type:""}),b(e.tmpDown,c);case 18:case"end":return t.stop()}}),t)}))),e}return Object(c.a)(n,[{key:"str2char",value:function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!==e.length;++r)n[r]=255&e.charCodeAt(r);return t}},{key:"getCharCol",value:function(e){for(var t="",n=0;e>0;)n=e%26+1,t=String.fromCharCode(n+64)+t,e=(e-n)/26;return t}},{key:"render",value:function(){var e=this.props,t=e.buttonText,n=void 0===t?"\u5bfc\u51faEXCEL":t,r=e.buttonSize,a=void 0===r?"default":r;return p.a.createElement(h.a,{onClick:this.downloadExcel,size:a},n)}}]),n}(l.Component);t.default=v}}]);
//# sourceMappingURL=42.a4e72131.chunk.js.map