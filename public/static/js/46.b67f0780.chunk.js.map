{"version":3,"sources":["components/editor/index.js"],"names":["View","props","handleEditorChange","content","onChange","data","toHTML","setState","handleUpload","param","filesimg","file","test","type","alert","size","uploadImg","error","imgSource","a","state","BraftEditor","createEditorState","value","this","otherProps","mediaConfig","allowPasteImage","video","audio","uploadFn","bind","className","media","Component"],"mappings":"mQAcMA,G,gEACJ,WAAYC,GAAQ,IAAD,8BACjB,cAAMA,IASRC,mBAAqB,SAACC,GAAa,IACzBC,EAAa,EAAKH,MAAlBG,SACFC,EAAOF,EAAQG,SACrB,EAAKC,SAAS,CAAEJ,QAASE,IACzBD,GAAYA,EAASC,IAdJ,EAoBnBG,aAAe,SAACC,GACd,IAAMC,EAAWD,EAAME,KAEvB,IAAK,aAAaC,KAAKF,EAASG,MAE9B,OADAC,MAAM,2DACC,EAELJ,EAASK,MALO,IAMlB,EAAKC,UAAUN,EAAUD,IAEzBA,EAAMQ,QACNH,MAAM,8DA/BS,EAsCnBE,UAtCmB,uCAsCP,WAAOE,EAAWT,GAAlB,SAAAU,EAAA,0FAtCO,wDAEjB,EAAKC,MAAQ,CACXjB,QAASkB,IAAYC,kBAAkBrB,EAAMsB,QAH9B,E,0CAsDnB,WAAW,IACDpB,EAAYqB,KAAKJ,MAAjBjB,QADA,EAEmCqB,KAAKvB,MAApBwB,GAFpB,EAEAF,MAFA,EAEOnB,SAFP,qCAGFsB,EAAc,CAClBC,iBAAiB,EACjBC,OAAO,EACPC,OAAO,EACPC,SAAUN,KAAKhB,aAAauB,KAAKP,OAEnC,OACE,kBAAC,IAAD,aACEQ,UAAU,eACVT,MAAOpB,EACPC,SAAUoB,KAAKtB,mBACf+B,MAAOP,GACHD,Q,GAtEOS,cA2EJlC","file":"static/js/46.b67f0780.chunk.js","sourcesContent":["import React, { Component } from 'react';\r\nimport BraftEditor from 'braft-editor'\r\nimport 'braft-editor/dist/index.css'\r\nimport './index.less'\r\n// const controls = [\r\n//   'undo', 'redo', 'separator',\r\n//   'font-size', 'line-height', 'letter-spacing', 'separator',\r\n//   'text-color', 'bold', 'italic', 'underline', 'strike-through', 'separator',\r\n//   'superscript', 'subscript', 'remove-styles', 'emoji',  'separator', 'text-indent', 'text-align', 'separator',\r\n//   'headings', 'list-ul', 'list-ol', 'blockquote', 'code', 'separator',\r\n//   'link', 'separator', 'hr', 'separator',\r\n//   'clear'\r\n// ]\r\n\r\nclass View extends Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {\r\n      content: BraftEditor.createEditorState(props.value)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 修改富文本的值\r\n   */\r\n  handleEditorChange = (content) => {\r\n    const { onChange } = this.props\r\n    const data = content.toHTML()\r\n    this.setState({ content: data })\r\n    onChange && onChange(data)\r\n  }\r\n\r\n  /**\r\n   * 上传图片验证\r\n   */\r\n  handleUpload = (param) => {\r\n    const filesimg = param.file\r\n    const fileMaxSize = 500000;\r\n    if (!/image\\/\\w+/.test(filesimg.type)) {\r\n      alert('选择的文件不是图片');\r\n      return false;\r\n    }\r\n    if (filesimg.size <= fileMaxSize) {\r\n      this.uploadImg(filesimg, param);\r\n    } else {\r\n      param.error()\r\n      alert(\"不能上传大于5M的图片\");\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 上传图片请求接口\r\n   */\r\n  uploadImg = async (imgSource, param) => {\r\n    // let formdata = new window.FormData()\r\n    // formdata.append('file', imgSource)\r\n    // const res = await httpUp(FILE_UPLOADTWO, formdata)\r\n    // try {\r\n    //   const data = res.data[0]\r\n    //   param.success({\r\n    //     url: data.url\r\n    //   })\r\n    // } catch (e) {\r\n\r\n    // } finally {\r\n\r\n    // }\r\n  }\r\n\r\n  render () {\r\n    const { content } = this.state\r\n    const { value, onChange, ...otherProps } = this.props\r\n    const mediaConfig = {\r\n      allowPasteImage: true,\r\n      video: true,\r\n      audio: true,\r\n      uploadFn: this.handleUpload.bind(this)\r\n    }\r\n    return (\r\n      <BraftEditor \r\n        className='braft-editor' \r\n        value={content} \r\n        onChange={this.handleEditorChange} \r\n        media={mediaConfig} \r\n        {...otherProps}\r\n      />\r\n    )\r\n  }\r\n}\r\nexport default View"],"sourceRoot":""}