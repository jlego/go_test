{"version":3,"sources":["components/detailview/index.js"],"names":["Text","Typography","Paragraph","Content","Layout","fullWidthComs","ComView","inject","globalStore","appStore","authStore","observer","formRef","React","createRef","id","state","loading","detailData","showResult","resultStatus","resultMsg","resultTitle","renderValue","name","loop","arr","data","length","key","shift","split","this","props","initData","tbName","urlQuery","Apis","appDetail","_id","queryToObj","tableName","then","result","setState","nextProps","item","component","comProps","Com","Coms","value","src","readOnly","title","items","fullWidthList","filter","includes","permissions","className","tip","spinning","size","labelStyle","width","textAlign","contentStyle","bordered","map","index","Item","label","span","Number","getComponent","style","marginTop","message","description","type","showIcon","margin","Component"],"mappings":"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","file":"static/js/59.21f0dae1.chunk.js","sourcesContent":["/**\n *  @Auther  yu\n *  @Time    2021-5-28\n */\nimport React, { Component } from \"react\";\nimport { inject, observer } from \"mobx-react\";\nimport {\n  Layout, Spin, Alert, Descriptions, Typography, Tag, Image, Rate,\n} from \"antd\";\nimport * as Coms from \"@/components\";\nimport { permissions, queryToObj, tableName } from \"@/components/utils/fun\";\nimport Apis from \"@/apis\";\nconst { Text, Paragraph } = Typography;\nconst { Content } = Layout;\nconst fullWidthComs = ['EditTable']\n\n@inject(({ globalStore, appStore, authStore }) => ({\n  ...globalStore, ...appStore, ...authStore\n}))\n@observer\nclass ComView extends Component {\n  formRef = React.createRef();\n  id = ''\n  state = {\n    loading: true,\n    detailData: {},\n    showResult: false,\n    resultStatus: true,\n    resultMsg: \"\",\n    resultTitle: '',\n  };\n\n  componentDidMount() {\n    this.id = this.props.id\n    this.initData()\n  }\n\n  initData() {\n    const { tbName, urlQuery } = this.props;\n    if (this.id) {\n      Apis.appDetail({ _id: this.id, ...queryToObj(urlQuery) }, tableName(tbName)).then(\n        (result) => {\n          if (result) {\n            this.setState({\n              detailData: result,\n              loading: false,\n            });\n          }\n        }\n      );\n    } else {\n      this.setState({ loading: false });\n    }\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps) {\n    const { id } = nextProps\n    if (id !== this.id) {\n      this.id = id\n      this.initData();\n    }\n  }\n\n  renderValue = name => {\n    let nameArr = name.split('.')\n    function loop(arr, data) {\n      if (arr.length > 1) {\n        let key = arr.shift()\n        if (data[key]) return loop(arr, data[key])\n      } else {\n        return data[arr[0]]\n      }\n    }\n    return loop(nameArr, this.state.detailData)\n  }\n\n  getComponent(item) {\n    let { component, name, comProps = {}, } = item;\n    let Com = Coms[component], value = this.renderValue(name) || '';\n    if (!component) return value\n    switch (component) {\n      case 'Tag':\n        return <Tag {...comProps}>{value}</Tag>\n      case 'Text':\n        return <Text {...comProps}>{value}</Text>\n      case 'Image':\n        return <Image {...comProps} src={value}></Image>\n      case 'Rate':\n        return <Rate {...comProps} value={value}></Rate>\n      case 'Paragraph':\n        return <Paragraph {...comProps}>{value}</Paragraph>\n      default:\n        return <Com readOnly={true} {...comProps} value={value}></Com>\n    }\n  }\n\n  render() {\n    const { tbName, title, items = [] } = this.props;\n    let fullWidthList = items.filter(item => fullWidthComs.includes(item.component))\n    return tbName ? (\n      <Content>\n        {permissions(tbName, `findOne`) ? (\n          <div className=\"app-content-div\">\n            <Spin tip=\"加载中...\" spinning={this.state.loading}>\n              <Descriptions\n                title={title}\n                size=\"small\"\n                labelStyle={{ width: '13%', textAlign: 'right' }}\n                contentStyle={{ width: '20%' }}\n                bordered\n              >\n                {\n                  items.filter(item => !fullWidthComs.includes(item.component)).map((item, index) => (\n                    <Descriptions.Item\n                      label={item.label}\n                      key={`0_${index}`}\n                      span={Number(item.span)}\n                      {...(item.comProps || {})}\n                    >\n                      {this.getComponent(item)}\n                    </Descriptions.Item>\n                  ))\n                }\n              </Descriptions>\n              {\n                fullWidthList.length ? fullWidthList.map((item, index) => (\n                  <div key={`1_${index}`}>\n                    <Descriptions title={item.label} style={{ marginTop: 20 }}></Descriptions>\n                    {this.getComponent(item) || ''}\n                  </div>\n                )) : null\n              }\n            </Spin>\n          </div>\n        ) : (\n          <Alert\n            message=\"信息提示\"\n            description=\"没有权限查看内容, 请联系管理员.\"\n            type=\"warning\"\n            showIcon\n            style={{ margin: \"0 20px\" }}\n          />\n        )}\n      </Content>\n    ) : (\n      <div className=\"app-spin\">\n        <Spin />\n      </div>\n    );\n  }\n}\n\nexport default ComView;\n"],"sourceRoot":""}